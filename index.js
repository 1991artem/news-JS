(()=>{"use strict";var e,t=function(){return t=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},t.apply(this,arguments)},o=function(){function e(e,t){this.baseLink=e,this.options=t}return e.prototype.getResp=function(e,t){var o=e.endpoint,r=void 0===o?"":o,n=e.options,c=void 0===n?{apiKey:"",sources:""}:n;void 0===t&&(t=function(){console.error("No callback for GET response")}),this.load("GET",r,t,c)},e.prototype.errorHandler=function(e){if(!e.ok)throw 401!==e.status&&404!==e.status&&426!==e.status||console.log("Sorry, but there is ".concat(e.status," error: ").concat(e.statusText)),Error(e.statusText);return e},e.prototype.makeUrl=function(e,o){var r=t(t({},this.options),e),n="".concat(this.baseLink).concat(o,"?");return Object.keys(r).forEach((function(e){n+="".concat(e,"=").concat(r[e],"&"),console.log(n)})),n.slice(0,-1)},e.prototype.load=function(e,t,o,r){void 0===r&&(r={apiKey:"",sources:""}),fetch(this.makeUrl(r,t),{method:e}).then(this.errorHandler).then((function(e){return e.json()})).then((function(e){return o(e)})).catch((function(e){return console.error(e)}))},e}(),r=(e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)},function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)});const n=function(e){function t(){return e.call(this,"https://nodenews.herokuapp.com/",{apiKey:"89945caab1794d879ad1345c019f5223"})||this}return r(t,e),t}(o);var c=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();const a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.getSources=function(t){var o=t.callback;e.prototype.getResp.call(this,{endpoint:"sources",options:{apiKey:"".concat(this.options.apiKey),sources:""}},o)},t.prototype.getNews=function(t){var o=t.e,r=t.callback;if(o.target&&o.currentTarget)for(var n=o.target,c=o.currentTarget;n!==c;){if(n.classList.contains("source__item")&&n.getAttribute("data-source-id")){if(n.getAttribute("data-source-id")){var a=n.getAttribute("data-source-id");c.getAttribute("data-source")!==a&&a&&(c.setAttribute("data-source",a),e.prototype.getResp.call(this,{endpoint:"everything",options:{apiKey:"".concat(this.options.apiKey),sources:a}},r))}return}n&&(n=n.parentNode)}},t.prototype.getNewsMobile=function(t){var o=t.e,r=t.callback,n=document.querySelector("#sources__select_input");(null==n?void 0:n.value)&&(o.currentTarget.setAttribute("data-source",null==n?void 0:n.value),e.prototype.getResp.call(this,{endpoint:"everything",options:{apiKey:"".concat(this.options.apiKey),sources:null==n?void 0:n.value}},r))},t}(n);var u=function(){function e(){}return e.prototype.draw=function(e){var t=e.length>=10?e.filter((function(e,t){return t<10})):e,o=document.createDocumentFragment(),r=document.querySelector("#newsItemTemp");r&&t.forEach((function(e,t){var n=r.content.cloneNode(!0);t%2&&n.querySelector(".news__item").classList.add("alt"),n.querySelector(".news__meta-photo").style.backgroundImage="url(".concat(e.urlToImage||"img/news_placeholder.jpg",")"),n.querySelector(".news__meta-author").textContent=e.author||e.source.name,n.querySelector(".news__meta-date").textContent=e.publishedAt.slice(0,10).split("-").reverse().join("-"),n.querySelector(".news__description-title").textContent=e.title,n.querySelector(".news__description-source").textContent=e.source.name,n.querySelector(".news__description-content").textContent=e.description,n.querySelector(".news__read-more a").setAttribute("href",e.url),o.append(n)})),document.querySelector(".news").innerHTML="",document.querySelector(".news").appendChild(o)},e}();const i=u,s=function(){function e(){}return e.prototype.draw=function(e){var t=document.createDocumentFragment(),o=document.querySelector("#sourceItemTemp");o&&e.forEach((function(e){if("object"==typeof e){var r=o.content.cloneNode(!0);r.querySelector(".source__item-name").textContent=e.name,r.querySelector(".source__item").setAttribute("data-source-id",e.id),t.append(r)}})),document.querySelector(".sources").append(t)},e.prototype.drawSelect=function(e){console.log(e);var t=document.createDocumentFragment(),o=document.querySelector("#sourceItemTempSelect");o&&e.forEach((function(e){if("object"==typeof e){var r=o.content.cloneNode(!0);r.querySelector(".source__item").setAttribute("data-source-id",e.id),r.querySelector(".source__item").setAttribute("value",e.id),t.append(r)}})),document.querySelector("#sources__select").append(t)},e}();var l,d;!function(e){e.category="#category",e.country="#country",e.language="#language"}(l||(l={})),function(e){e.category="category",e.country="country",e.language="language"}(d||(d={}));var p=function(){function e(){this.category=null,this.country=null,this.language=null,this.filterArray=[]}return e.prototype.filter=function(){return this.category=document.querySelector(l.category),this.country=document.querySelector(l.country),this.language=document.querySelector(l.language),this.category&&this.filterCategory(this.category,0),this.country&&this.filterCategory(this.country,1),this.language&&this.filterCategory(this.language,2),this.filterArray},e.prototype.filterCategory=function(e,t){var o=this;this.filterArray[t]=e.value,null==e||e.addEventListener("change",(function(){e&&(o.filterArray[t]=e.value)}))},e.prototype.filterData=function(e){var t=this.filter(),o=[];return console.log(t),e.forEach((function(e){var r=!(!Object.values(e).includes(t[0])&&"all"!==t[0]),n=!(!Object.values(e).includes(t[1])&&"all"!==t[1]),c=!(!Object.values(e).includes(t[2])&&"all"!==t[2]);r&&n&&c&&o.push(e)})),o},e}(),y=function(){function e(){this.news=new i,this.sources=new s,this.filter=new p}return e.prototype.drawNews=function(e){if(e.articles){var t=(null==e?void 0:e.articles)?null==e?void 0:e.articles:[];this.news.draw(t)}},e.prototype.drawSources=function(e){var t=(null==e?void 0:e.sources)?null==e?void 0:e.sources:[];window.innerWidth>=1e3?this.sources.draw(this.filter.filterData(t)):this.sources.drawSelect(this.filter.filterData(t))},e}();const f=function(){function e(){}return e.prototype.addCheckArea=function(e){if(e.sources){var t=e.sources,o=document.querySelector(".check__type"),r={category:new Set,country:new Set,language:new Set};for(var n in r){var c=document.createElement("p3"),a=document.createElement("select");o&&(o.append(c),o.append(a),a.classList.add("news__category_select"),a.id=n,c.classList.add("news__category_name"),c.innerHTML="News "+n)}r.category.add("all"),r.country.add("all"),r.language.add("all"),t.forEach((function(e){r.category.add(e[d.category]),r.country.add(e[d.country]),r.language.add(e[d.language])})),this.addCategory(d.category,r[d.category]),this.addCategory(d.country,r[d.country]),this.addCategory(d.language,r[d.language])}},e.prototype.addCategory=function(e,t){t.forEach((function(t){var o=document.querySelector("#".concat(e)),r=document.createElement("option");r.classList.add(".option"),null==o||o.append(r),r.innerHTML=t}))},e}();(new(function(){function e(){this.controller=new a,this.view=new y,this.filter=new f}return e.prototype.start=function(){var e=this,t=document.querySelector(".sources"),o=document.querySelector("#sources__select_input"),r=document.querySelector("#sources__select"),n=document.querySelector(".news");window.innerWidth>=1e3?t&&t.addEventListener("click",(function(t){return e.controller.getNews({e:t,callback:function(t){t&&e.view.drawNews(t)}})})):o&&(o.addEventListener("change",(function(t){e.controller.getNewsMobile({e:t,callback:function(t){t&&e.view.drawNews(t)}})})),o.addEventListener("click",(function(e){o.value=""}))),this.controller.getSources({callback:function(c){c&&(e.filter.addCheckArea(c),e.view.drawSources(c),[document.querySelector(l.category),document.querySelector(l.country),document.querySelector(l.language)].forEach((function(a){null==a||a.addEventListener("change",(function(){t&&(t.innerHTML=""),o&&(o.value=""),r&&(r.innerHTML=""),n&&(n.innerHTML=""),e.view.drawSources(c)}))})))}})},e}())).start()})();